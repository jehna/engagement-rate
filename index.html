<!-- <?php
ini_set("error_reporting", 1);
//https://graph.facebook.com/oauth/access_token?grant_type=fb_exchange_token&client_id=816021041756653&client_secret=a0046b7d41f4df08e861e0b3029d6e97&fb_exchange_token=CAALmKrRSue0BAECfhKBtHm2tXf1I5daVVmLDdSgxRoXZB2qsdjRSKUz8BuEGIhzSRxzEB8xfpQCXOtsdi1VYQN9rqYtt5oL4JJjQjKBWltZBnA6ZBZAXvUnLscVi7LFIOZAzcH2WHVb7fF6nX2KQXX70oJ7t8ZAR7FEFyI6lU8ZCZCrnCDaaxPvTp8SgpG5bNkoZD
$access_token = "CAALmKrRSue0BAJo1C4RpDjbtMw9TUEBOuJGCWeapJvXUWS1ZBEJm10vIJ6g3LAFAoXBpzFWAcxCFpApPvYIx08XFYjN4YsBBAkgQt6smJ7DMjFZAix8Fotq1wjLTrdJyMiimWIwKpWY5z1MFYZB0ZCyaM3rUo676NBnrJ7rEIhWRyvF6xcnO";

function fbAPI($path, $cache_time = 1800, $params) {
	global $access_token;
	
	$params->access_token = $access_token;
	$q = http_build_query($params);

	$cache_name = './cache/' . md5($path . $q);
	if( time() - filemtime($cache_name) < $cache_time ) {
		return file_get_contents( $cache_name );
	} else {
		$url = "https://graph.facebook.com/v2.0/" . $path . "?" . $q;
		$data = file_get_contents($url);
		file_put_contents($cache_name, $data);
		return $data;
	}
}

$posts = json_decode(fbAPI('me/posts'));
foreach($posts->data as $post) {
	$post->insigths = json_decode(fbAPI($post->id . "/insights/post_impressions_unique,post_engaged_users"));
}

?> -->
<!DOCTYPE html>
<html>
<head>
	<title>Engagement Rate visualizer</title>
	<link rel="stylesheet" href="styles.css">
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
	<script type="text/javascript" src="circles.min.js"></script>
</head>
<body>
	<div class="bg">
	</div>
	
	<h1>Engagement rate</h1>
	
	<div id="fb-root"></div>
	<div id="pimpum"></div>
	<small>
		20 most recent FB posts from CreateTrips with calculated Engagement Rates (The number of people who clicked anywhere in your posts [divided by] The number of people who saw your Page post).<br />
		Background is <a href="http://thepatternlibrary.com/#brijan" rel="nofollow">Brijan</a> by Brijan Powell, from thepatternlibrary.
		The awesome <a href="https://github.com/lugolabs/circles" rel="nofollow">Circles plugin</a> by Artan Sinani<br />
		Licensed under <a href="LICENSE">MIT license</a>.
	</small>

	<script src="scripts.js" async></script>

	<!-- FB SDK -->
	<script>(function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/all.js#xfbml=1"; fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk'));</script>
</body>
</html>
